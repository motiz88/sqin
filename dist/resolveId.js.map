{"version":3,"sources":["src/resolveId.js"],"names":[],"mappings":";;;;;qBAMS,SAAS;;;;oBAND,MAAM;;;;oBACR,OAAO;;;;kBACP,IAAI;;;;AAInB,SAAS,SAAS,CAAC,EAAE,EAAE,OAAO,EAAE,aAAa,EAAE;AAC3C,QAAI,CAAC,aAAa,EACd,aAAa,GAAG,EAAE,CAAC;;AAEvB,QAAI,EAAE,IAAI,aAAa,EACnB,OAAO,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,CAAC;;AAE9C,WAAO,CAAC,GAAG,CAAC,YAAY,EAAE,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;AAC7C,QAAI,UAAU,GAAG,kBAAK,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;;AAG3C,QAAI,UAAU,GAAG,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;;AAE9B,WAAO,gBAAG,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CACpC,GAAG,CAAC,UAAA,GAAG;eAAI,UAAU,GAAG,GAAG;KAAA,CAAC,CAC5B,SAAS,CAAC,UAAU,WAAW,EAAE;AAC9B,eAAO,gBAAG,UAAU,CAAC,WAAW,CAAC,kBAAG,MAAM,CAAC,WAAW,CAAC,CAAC,CACnD,MAAM,CAAC,OAAO,CAAC;SACf,GAAG,CAAC,YAAY;AAAE,mBAAO,WAAW,CAAC;SAAE,CAAC,CAAC;KACjD,CAAC,CACD,KAAK,EAAE,CACP,GAAG,CAAC,UAAA,UAAU,EAAI;AAAC,qBAAa,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC;KAAC,CAAC,CACpD,SAAS,EAAE,CAAC;CAChB","file":"src/resolveId.js","sourcesContent":["import path from 'path';\r\nimport fs from 'mz/fs';\r\nimport Rx from 'rx';\r\n\r\nexport default\r\nfunction resolveId(id, baseDir, resolvedCache) {\r\n    if (!resolvedCache)\r\n        resolvedCache = {};\r\n\r\n    if (id in resolvedCache)\r\n        return Promise.resolve(resolvedCache[id]);\r\n\r\n    console.log('looking up', id, 'in', baseDir);\r\n    var resolvedId = path.resolve(baseDir, id);\r\n    \r\n\r\n    var extensions = ['', '.sql'];\r\n\r\n    return Rx.Observable.from(extensions)\r\n    .map(ext => resolvedId + ext)\r\n    .concatMap(function (attemptedId) {\r\n        return Rx.Observable.fromPromise(fs.exists(attemptedId))\r\n            .filter(Boolean) // filter falsy values\r\n            .map(function () { return attemptedId; });\r\n    })\r\n    .first()\r\n    .tap(resolvedId => {resolvedCache[id] = resolvedId;})\r\n    .toPromise();\r\n}"]}